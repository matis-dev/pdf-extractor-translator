============================= test session starts ==============================
platform linux -- Python 3.12.7, pytest-7.4.4, pluggy-1.0.0 -- /home/matis/anaconda3/bin/python
cachedir: .pytest_cache
rootdir: /home/matis/Desktop/projects/pdf
plugins: Faker-38.2.0, base-url-2.1.0, flask-1.3.0, mock-3.15.1, playwright-0.7.2, anyio-4.6.2
collecting ... collected 1 item

tests/test_frontend.py::test_dark_mode[chromium] PAGEERROR: Identifier 'loadPdf' has already been declared
PAGEERROR: toggleDarkMode is not defined
FAILED

=================================== FAILURES ===================================
___________________________ test_dark_mode[chromium] ___________________________

page = <Page url='http://localhost:5001/editor/dark_mode.pdf'>
live_server_url = 'http://localhost:5001'

    def test_dark_mode(page: Page, live_server_url):
        """Test dark mode toggle persistence and effect."""
        # Create dummy PDF
        from reportlab.pdfgen import canvas
        pdf_name = "dark_mode.pdf"
        absolute_pdf_path = os.path.abspath(pdf_name)
        c = canvas.Canvas(absolute_pdf_path)
        c.drawString(100, 750, "Dark Mode Test")
        c.save()
    
        try:
            page.on("console", lambda msg: print(f"CONSOLE: {msg.text}"))
            page.on("pageerror", lambda err: print(f"PAGEERROR: {err}"))
    
            page.goto(live_server_url)
    
            # Upload
            page.set_input_files("input#pdf_file", absolute_pdf_path)
            page.get_by_text("Upload & Edit").click()
    
            # Wait for toggle
            expect(page.locator("#theme-toggle")).to_be_visible(timeout=10000)
    
            # Check default (light)
            expect(page.locator("body")).not_to_have_attribute("data-theme", "dark")
    
            # Click toggle
            page.locator("#theme-toggle").click()
    
            # Check dark mode active
>           expect(page.locator("body")).to_have_attribute("data-theme", "dark")
E           AssertionError: Locator expected to have attribute 'dark'
E           Actual value: None 
E           Call log:
E             - Expect "to_have_attribute" with timeout 5000ms
E             - waiting for locator("body")
E               9 × locator resolved to <body>…</body>
E                 - unexpected value "null"

tests/test_frontend.py:178: AssertionError
=============================== warnings summary ===============================
<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: Type google.protobuf.pyext._message.ScalarMapContainer uses PyType_Spec with a metaclass that has custom tp_new. This is deprecated and will no longer be allowed in Python 3.14.

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: Type google.protobuf.pyext._message.MessageMapContainer uses PyType_Spec with a metaclass that has custom tp_new. This is deprecated and will no longer be allowed in Python 3.14.

../../../anaconda3/lib/python3.12/site-packages/pydantic/_internal/_fields.py:161
  /home/matis/anaconda3/lib/python3.12/site-packages/pydantic/_internal/_fields.py:161: UserWarning: Field "model_path" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

../../../anaconda3/lib/python3.12/site-packages/pydantic/_internal/_fields.py:161
  /home/matis/anaconda3/lib/python3.12/site-packages/pydantic/_internal/_fields.py:161: UserWarning: Field "model_spec" has conflict with protected namespace "model_".
  
  You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_frontend.py::test_dark_mode[chromium] - AssertionError: Loc...
======================== 1 failed, 6 warnings in 15.44s ========================
sys:1: DeprecationWarning: builtin type swigvarlink has no __module__ attribute
